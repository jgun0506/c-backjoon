#define _CRT_SECURE_NO_WARNINGS
#pragma comment(linker, "/STACK:28388608")   // 8MB 스택메모리늘려줌
#include <stdio.h>
#include <stdlib.h>    // srand, rand 함수가 선언된 헤더 파일
#include <string.h>
#include <stdbool.h>
#include <stddef.h>
#include <math.h>

/*
1.언제 회전시켜야할까??(회전을 시키면서 확인하면 안됨)
2.한번에 회전처리를 어떻게 할까?
3.띄어쓰기안하고 입력받는 정수는 어떻게 구별할까?
*/

int wheel[5][8];
int k;//회전횟수

void turn(int num, int direct) {//n번째 바퀴를 시계/반시계방향으로 회전
    
    int temp[8];
    for (int i = 0; i < 8; i++) {
        temp[i] = wheel[num][i];
    }

    if (direct == 1) {//시계방향
        for (int i = 0; i < 8; i++) {
            if (i != 7)
                temp[i + 1] = wheel[num][i];
            else {
                temp[0] = wheel[num][i];
            }
        }
    }
    else if (direct == -1) {//반시계방향
        for (int i = 0; i < 8; i++) {
            if (i != 0)
                temp[i - 1] = wheel[num][i];
            else {
                temp[7] = wheel[num][i];
            }
        }
    }
    for (int i = 0; i < 8; i++) {
        wheel[num][i] = temp[i];
    }
}

void func(int num, int direct) {//n번째 톱니바퀴 회전 시키는 함수
    int rotate[5] = { 0, };
    rotate[num] = direct;

    //오른쪽에 잇는 바퀴 움직임여부
    int i = num;
    int di = direct;
    while (i < 4) {
        if (wheel[i][2] != wheel[i + 1][6]) {
            di *= -1;
            rotate[i + 1] = di;
            i++;
        }
        else {
            break;
        }
    }
    //왼쪽에 잇는 바퀴 움직임여부
    i = num;
    di = direct;
    while (i > 1) {
        if (wheel[i][6] != wheel[i - 1][2]) {
            di *= -1;
            rotate[i - 1] = di;
            i--;
        }
        else {
            break;
        }
    }
    
    for (int i = 1; i <= 4; i++) {
        turn(i, rotate[i]);
    }
}


int main(){

    for (int i = 1; i <= 4; i++) {
        for (int j = 0; j < 8; j++) {
            scanf("%1d", &wheel[i][j]);
        }
    }
    
    scanf("%d", &k);

    while (k) {
        int num;
        int direct;
        scanf("%d %d", &num, &direct);
        func(num, direct);
        k--;
    }

    int sum = 0;

    for (int i = 0; i < 4; i++) {
        sum += wheel[i + 1][0] << i;
    }
    printf("%d", sum);
    return 0;
}
